---
title: Selenium - 安装与入门
description: 中文版的Selenium使用文档：使用Python的Selenium拓展包进行网页爬虫，内容包括Selenium的安装与入门。
categories:
 - Python
tags: Python
---

Written by  **Zuricho**

Github blog：[zuricho.github.io](zuricho.github.io)




> 这并不是一篇官方文档。本篇文档翻译并修改自非官方文档[Selenium for Python](https://github.com/baijum/selenium-python)，本文在原文基础上有适量改动。原文作者欢迎各位共同建设这篇Selenium的非官方文档。

# 1. 安装

##1.1. 简介

Selenium Python bindings provides a simple API to write functional/acceptance tests using Selenium WebDriver. Through Selenium Python API you can access all functionalities of Selenium WebDriver in an intuitive way.

Selenium Python bindings provide a convenient API to access Selenium WebDrivers like Firefox, Ie, Chrome, Remote etc. The current supported Python versions are 2.7, 3.5 and above.

This documentation explains Selenium 2 WebDriver API. Selenium 1 / Selenium RC API is not covered here.

## 1.2. 下载带有Selenium的Python

You can download Python bindings for Selenium from the [PyPI page for selenium package](https://pypi.python.org/pypi/selenium). However, a better approach would be to use [pip](https://pip.pypa.io/en/latest/installing/) to install the selenium package. Python 3.6 has pip available in the [standard library](https://docs.python.org/3.6/installing/index.html). Using pip, you can install selenium like this:

```
pip install selenium
```

You may consider using [virtualenv](http://www.virtualenv.org/) to create isolated Python environments. Python 3.6 has [pyvenv](https://docs.python.org/3.6/using/scripts.html#scripts-pyvenv)which is almost same as virtualenv.

## 1.3. 驱动

Selenium requires a driver to interface with the chosen browser. Firefox, for example, requires [geckodriver](https://github.com/mozilla/geckodriver/releases), which needs to be installed before the below examples can be run. Make sure it’s in your PATH, e. g., place it in /usr/bin or /usr/local/bin.

Failure to observe this step will give you an error selenium.common.exceptions.WebDriverException: Message: ‘geckodriver’ executable needs to be in PATH.

Other supported browsers will have their own drivers available. Links to some of the more popular browser drivers follow.

| **Chrome**:  | <https://sites.google.com/a/chromium.org/chromedriver/downloads> |
| ------------ | ------------------------------------------------------------ |
| **Edge**:    | <https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/> |
| **Firefox**: | <https://github.com/mozilla/geckodriver/releases>            |
| **Safari**:  | <https://webkit.org/blog/6900/webdriver-support-in-safari-10/> |

## 1.4. Windows用户注意事项

Note

You should have an internet connection to perform this installation.

1. Install Python 3.6 using the [MSI available in python.org download page](http://www.python.org/download).

2. Start a command prompt using the `cmd.exe` program and run the `pip` command as given below to install selenium.

   ```
   C:\Python35\Scripts\pip.exe install selenium
   ```

Now you can run your test scripts using Python. For example, if you have created a Selenium based script and saved it inside `C:\my_selenium_script.py`, you can run it like this:

```
C:\Python35\python.exe C:\my_selenium_script.py
```

## 1.5. 下载Selenium服务器

注意：

**只有在你想使用远程WebDriver时才会需要使用Selenium服务器。**. See the [Using Selenium with remote WebDriver](http://selenium-python.readthedocs.io/getting-started.html#selenium-remote-webdriver) section for more details. If you are a beginner learning Selenium, you can skip this section and proceed with next chapter.

Selenium server is a Java program. Java Runtime Environment (JRE) 1.6 or newer version is recommended to run Selenium server.

You can download Selenium server 2.x from the [download page of selenium website](http://seleniumhq.org/download/). The file name should be something like this: `selenium-server-standalone-2.x.x.jar`. You can always download the latest 2.x version of Selenium server.

If Java Runtime Environment (JRE) is not installed in your system, you can download the [JRE from the Oracle website](http://www.oracle.com/technetwork/java/javase/downloads/index.html). If you are using a GNU/Linux system and have root access in your system, you can also use your operating system instructions to install JRE.

If java command is available in the PATH (environment variable), you can start the Selenium server using this command:

```
java -jar selenium-server-standalone-2.x.x.jar
```

Replace 2.x.x with the actual version of Selenium server you downloaded from the site.

If JRE is installed as a non-root user and/or if it is not available in the PATH (environment variable), you can type the relative or absolute path to the java command. Similarly, you can provide a relative or absolute path to Selenium server jar file. Then, the command will look something like this:

```
/path/to/java -jar /path/to/selenium-server-standalone-2.x.x.jar
```

 

这个内容有中文版本参考：http://blog.csdn.net/u012359618/article/details/52556127

Chrome相关文件下载可以直接google搜索



# 2. 入门

## 2.1. 简单使用

If you have installed Selenium Python bindings, you can start using it from Python like this.

```python
from selenium import webdriver
from selenium.webdriver.common.keys import Keys

driver = webdriver.Chrome()
driver.get("http://www.python.org")
assert "Python" in driver.title
elem = driver.find_element_by_name("q")
elem.clear()
elem.send_keys("pycon")
elem.send_keys(Keys.RETURN)
assert "No results found." not in driver.page_source
driver.close()
```

The above script can be saved into a file (eg:- python_org_search.py), then it can be run like this:

```
python python_org_search.py
```

The python which you are running should have the selenium module installed.



## 2.2. 例子的解释

The selenium.webdriver module provides all the WebDriver implementations. Currently supported WebDriver implementations are Firefox, Chrome, IE and Remote. The Keys class provide keys in the keyboard like RETURN, F1, ALT etc.

selenium.webdriver模块提供了所有WebDriver的功能，支持火狐，chrome，IE等浏览器。Keys class提供键盘中的Return，F1，Alt等键。

```
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
```

Next, the instance of Firefox WebDriver is created.

```
driver = webdriver.Firefox()
```

The driver.get method will navigate to a page given by the URL. WebDriver will wait until the page has fully loaded (that is, the “onload” event has fired) before returning control to your test or script. It’s worth noting that if your page uses a lot of AJAX on load then WebDriver may not know when it has completely loaded.:

driver.get方法会引导向URL指向的相应页面。webdriver会等待页面完全载入后再运行后续代码。

```
driver.get("http://www.python.org")
```

The next line is an assertion to confirm that title has “Python” word in it:

下一条命令用于确认标题中存在Python字段。

```
assert "Python" in driver.title
```

WebDriver offers a number of ways to find elements using one of the find_element_by_* methods. For example, the input text element can be located by its name attribute using find_element_by_name method. A detailed explanation of finding elements is available in the[Locating Elements](http://selenium-python.readthedocs.io/locating-elements.html#locating-elements) chapter:

WebDriver提供一系列的fine_element_by_*方法来查找网页中的元素。细节会在第四单元中讲到。

```
elem = driver.find_element_by_name("q")
```

Next, we are sending keys, this is similar to entering keys using your keyboard. Special keys can be sent using Keys class imported from selenium.webdriver.common.keys. To be safe, we’ll first clear any pre-populated text in the input field (e.g. “Search”) so it doesn’t affect our search results:

接下来我们便需要进行键盘输入，就像是利用键盘上的键进行输入一样。

```python
elem.clear()
elem.send_keys("pycon")
elem.send_keys(Keys.RETURN)
```

After submission of the page, you should get the result if there is any. To ensure that some results are found, make an assertion:

```
assert "No results found." not in driver.page_source
```

Finally, the browser window is closed. You can also call quit method instead of close. The quit will exit entire browser whereas `close` will close one tab, but if just one tab was open, by default most browser will exit entirely.:

```
driver.close()
```

## 2.3. 使用Selenium构建测试

Selenium is mostly used for writing test cases. The selenium package itself doesn’t provide a testing tool/framework. You can write test cases using Python’s unittest module. The other options for a tool/framework are py.test and nose.

In this chapter, we use unittest as the framework of choice. Here is the modified example which uses unittest module. This is a test for python.org search functionality:

```python
import unittest
from selenium import webdriver
from selenium.webdriver.common.keys import Keys

class PythonOrgSearch(unittest.TestCase):

    def setUp(self):
        self.driver = webdriver.Firefox()

    def test_search_in_python_org(self):
        driver = self.driver
        driver.get("http://www.python.org")
        self.assertIn("Python", driver.title)
        elem = driver.find_element_by_name("q")
        elem.send_keys("pycon")
        elem.send_keys(Keys.RETURN)
        assert "No results found." not in driver.page_source


    def tearDown(self):
        self.driver.close()

if __name__ == "__main__":
    unittest.main()
```

You can run the above test case from a shell like this:

```
python test_python_org_search.py
.
----------------------------------------------------------------------
Ran 1 test in 15.566s

OK
```

The above result shows that the test has been successfully completed.

## 2.4. 例子的细节解释

Initially, all the basic modules required are imported. The [unittest](http://docs.python.org/library/unittest.html) module is a built-in Python based on Java’s JUnit. This module provides the framework for organizing the test cases. The selenium.webdriver module provides all the WebDriver implementations. Currently supported WebDriver implementations are Firefox, Chrome, Ie and Remote. The Keys class provide keys in the keyboard like RETURN, F1, ALT etc.

```
import unittest
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
```

The test case class is inherited from unittest.TestCase. Inheriting from TestCase class is the way to tell unittest module that this is a test case:

```
class PythonOrgSearch(unittest.TestCase):
```

The setUp is part of initialization, this method will get called before every test function which you are going to write in this test case class. Here you are creating the instance of Firefox WebDriver.

```
def setUp(self):
    self.driver = webdriver.Firefox()
```

This is the test case method. The test case method should always start with characters test. The first line inside this method create a local reference to the driver object created in setUp method.

```
def test_search_in_python_org(self):
    driver = self.driver
```

The driver.get method will navigate to a page given by the URL. WebDriver will wait until the page has fully loaded (that is, the “onload” event has fired) before returning control to your test or script. It’s worth noting that if your page uses a lot of AJAX on load then WebDriver may not know when it has completely loaded.:

```
driver.get("http://www.python.org")
```

The next line is an assertion to confirm that title has “Python” word in it:

```
self.assertIn("Python", driver.title)
```

WebDriver offers a number of ways to find elements using one of the find_element_by_* methods. For example, the input text element can be located by its name attribute using find_element_by_name method. Detailed explanation of finding elements is available in the[Locating Elements](http://selenium-python.readthedocs.io/locating-elements.html#locating-elements) chapter:

```
elem = driver.find_element_by_name("q")
```

Next, we are sending keys, this is similar to entering keys using your keyboard. Special keys can be send using Keys class imported from selenium.webdriver.common.keys:

```
elem.send_keys("pycon")
elem.send_keys(Keys.RETURN)
```

After submission of the page, you should get the result as per search if there is any. To ensure that some results are found, make an assertion:

```
assert "No results found." not in driver.page_source
```

The tearDown method will get called after every test method. This is a place to do all cleanup actions. In the current method, the browser window is closed. You can also call quit method instead of close. The quit will exit the entire browser, whereas close will close a tab, but if it is the only tab opened, by default most browser will exit entirely.:

```
def tearDown(self):
    self.driver.close()
```

Final lines are some boiler plate code to run the test suite:

```
if __name__ == "__main__":
    unittest.main()
```

## 2.5. 远程WebDriver使用Selenium

To use the remote WebDriver, you should have Selenium server running. To run the server, use this command:

```
java -jar selenium-server-standalone-2.x.x.jar
```

While running the Selenium server, you could see a message looking like this:

```
15:43:07.541 INFO - RemoteWebDriver instances should connect to: http://127.0.0.1:4444/wd/hub
```

The above line says that you can use this URL for connecting to remote WebDriver. Here are some examples:

```
from selenium import webdriver
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities

driver = webdriver.Remote(
   command_executor='http://127.0.0.1:4444/wd/hub',
   desired_capabilities=DesiredCapabilities.CHROME)

driver = webdriver.Remote(
   command_executor='http://127.0.0.1:4444/wd/hub',
   desired_capabilities=DesiredCapabilities.OPERA)

driver = webdriver.Remote(
   command_executor='http://127.0.0.1:4444/wd/hub',
   desired_capabilities=DesiredCapabilities.HTMLUNITWITHJS)
```

The desired capabilities is a dictionary, so instead of using the default dictionaries, you can specify the values explicitly:

```
driver = webdriver.Remote(
   command_executor='http://127.0.0.1:4444/wd/hub',
   desired_capabilities={'browserName': 'htmlunit',
                         'version': '2',
                        'javascriptEnabled': True})
```


